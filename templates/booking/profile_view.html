{% extends "base.html" %}
{% block title %}–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å ‚Äî BookEasy{% endblock %}

{% block content %}
<h2>üë§ –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</h2>


<div class="mb-4 text-start">
    <p><strong>–Ü–º º—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</strong> {{ request.user.username }}</p>
    <p><strong>Email:</strong> {{ request.user.email }}</p>
    <p><strong>–î–∞—Ç–∞ –ø—Ä–∏—î–¥–Ω–∞–Ω–Ω—è:</strong> {{ request.user.date_joined|date:"d.m.Y" }}</p>
</div>

<button class="btn-main" onclick="toggleBookings()">üìã –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è</button>

<div id="bookings-block" class="mt-4" style="display: none;">
    <h3>–í–∞—à—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è</h3>

    {% if bookings %}
        <ul class="list-group">
            {% for booking in bookings %}
            {% if location.image %}
                <img src="{{ location.image.url }}" alt="{{ location.title }}" width="200" class="img-thumbnail mb-3">
            {% endif %}

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div>
                        <strong>–õ–æ–∫–∞—Ü—ñ—è:</strong> {{ booking.location.title }} <br>
                        <strong>–ü–æ—á–∞—Ç–æ–∫:</strong> {{ booking.start_date|date:"d.m.Y" }} <br>
                        <strong>–ö—ñ–Ω–µ—Ü—å:</strong> {{ booking.end_date|date:"d.m.Y" }} <br>
                        <strong>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ:</strong>
                        {% if booking.is_confirmed %}
                            <span class="text-success">–¢–∞–∫</span>
                        {% else %}
                            <span class="text-warning">–ù—ñ</span>
                        {% endif %}
                    </div>

                    {% if not booking.is_confirmed %}
                    <form method="post" action="{% url 'main:delete_booking' booking.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-sm mt-2">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </form>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="mt-3">–£ –≤–∞—Å –Ω–µ–º–∞—î –±—Ä–æ–Ω—é–≤–∞–Ω—å.</p>
    {% endif %}
</div>

<div class="mt-4">
    <a href="{% url 'main:home' %}" class="btn btn-outline-secondary">‚¨ÖÔ∏è –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
</div>

<script>
    function toggleBookings() {
        const block = document.getElementById('bookings-block');
        block.style.display = block.style.display === 'none' ? 'block' : 'none';
    }
</script>
{% endblock %}
